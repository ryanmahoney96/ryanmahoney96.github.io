

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
	
	<link rel = "stylesheet" href="css/styles.css">
	
	<title>Mahoney Bank Mortgage Calculation Tool</title>
  </head>
  
  <!--Instructions:
	Homework 2 asks you to write a javascript program that uses a form to gather input and the DOM manipulation techniques we learned in class to display some results.

	The problem is to calculate a mortgage schedule for someone thinking of buying a new house.

	The inputs to determine a monthly schedule are the principal loan amount, the annual interest rate, and the number of months for the loan.

	Most mortgages are for 30 years but you should give the user the option of calculating 15, 20, or 30 year loans.

	Your program should prompt for these values using some of the inputs we discussed (text boxes, drop down list, etc.) and find a monthly payment using this calculation:

									monthly interest rate 
	monthly payment = ------------------------------------------------- * principal
					  1 - (1 + monthly interest rate)^-number of months

	You will have to calculate the monthly interest rate since the user will enter in an annual interest rate.

	The ^ in this equation means raise one number to a power. Look at the built in Math object for a function that raises one number to a power.

	Create a table that holds a summary of the loan amount, the interest rate, the monthly payment, the total amount paid for the loan, the total amount of interest paid, and the ratio of amount paid over the principal.

	Once you have a monthly payment you can begin to make the schedule.

	The schedule should include the month number, the monthly payment, the amount paid in principal and in interest in that month, and the amount remaining in the principal (the amount paid in principle each month is deducted from the remaining principle).

	A month's interest amount is equal to monthly interest rate times the remaining principal.

	The monthly principal is the difference between the monthly payment and the monthly interest paid.

	Remember to update the remaining principal after every month.

	After every year ends, display the year number.

	All of this data should be displayed in a table.

	The program should have inputs so that the user can enter a range of months (1 - 360) to show from the schedule.

	Use css and bootstrap to give the page a professional look.

	Upload the finished product to GitHub and send me a comment with the link.
	-->
  
  <body>
  
	<header>
		<h1>Welcome to Mahoney Bank and Trust</h1>
	</header>
	
	<div class = "container">
		<fieldset>
			<legend>
			<marquee>
				Mahoney Bank's Mortgage Calculation Tool
			</marquee>
			</legend>
			
			<form id = "inputForm" role = "form">
				
				<div class = "form-group">
					<label for = "principleLoan">Enter in the Principle Loan Amount:</label>
					<input type = "text" class = "form-control" id = "principleLoan" placeholder = "Principle Loan Amount"/>
				</div>
				
				
				<div class = "form-group">
					<label for = "annualInterestRate">Enter in your Annual Interest Rate:</label>
					<input type = "text" class = "form-control" id = "annualInterestRate" placeholder = "Annual Interest Rate"/>
				</div>
		
				<div class = "form-group">
					<label for = "numYears">Over what period of time will you pay the loan?</label>
					<div class = "dropdown">
						<button id = "ddButton" class = "btn dropdown-toggle" type = "button" data-toggle = "dropdown">
							Select a Loan Period
						<span class = "glyphicon glyphicon-circle-arrow-down"></span>
						</button>
						<ul id = "ddList" class = "dropdown-menu">
							<li><a href="#" value = "10" class ="numYears">10 years</a></li>
							<li><a href="#" value = "15" class ="numYears">15 years</a></li>
							<li><a href="#" value = "20" class ="numYears">20 years</a></li>
							<li><a href="#" value = "25" class ="numYears">25 years</a></li>
							<li><a href="#" value = "30" class ="numYears">30 years</a></li>
						</ul>	
					</div>
				</div>
				
				<div class = "form-group">
					
					<button type="button" id="clearButton" class = "btn pull-right">Clear</button>
				
					<button type = "button" id = "formSubmission" class = "btn pull-right">Submit Your Information</button>
					<br/>
					<hr>
				</div>
							
				<div class = "fromTo form-group col-sm-5">
					<label for = "firstMonth">Enter in the First Month you would like to view from:</label>
					<input type = "text" class = "form-control" id = "firstMonth" placeholder = "First Month"/>
				</div>
				
				
				<div class = "fromTo form-group col-sm-5">
					<label for = "lastMonth">Enter in the Last Month you would like to view to:</label>
					<input type = "text" class = "form-control" id = "lastMonth" placeholder = "Last Month"/>
				</div>
				
				<button type = "button" id = "timeSpan" class = "btn fromTo col-sm-2">Submit</button>
				<br/>
			</form>
			
			<div>
				<table id="mortgageTable" class="table table-striped table-bordered table-hover" style = "visibility:hidden">
					
					<tr>
						<th>
							Month Number
						</th>
						
						<th>
							Amount to Pay This Month
						</th>
						
						<th>
							Principle Paid
						</th>
						
						<th>
							Interest Paid
						</th>
						
						<th>
							Principle Remaining
						</th>
					</tr>
					
				</table>
			</div>
			
		</fieldset>
	</div>
	
	
	
	
	
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	
	<script>
		$(document).ready(function() {
			console.log("DOM loaded");
				
			var numMonths = 0;	
			var gnumMonths;
			var monthlyPayment;	
				
			var submitted = false;
			
			$(".numYears").on("click", function(){
				$("#ddButton").text($(this).text());
				numMonths = 12 * ($(this).attr("value"));
				setNumMonths(numMonths);
			});
			
			var clearButton = $("#clearButton");
			clearButton.on("click", clear);
			
			var submitData = $("#formSubmission");
			submitData.on("click", paymentCalculator);
			
			var timeSpanEnter = $("#timeSpan");
			timeSpanEnter.on("click", timeSpanFunc);
			
			function paymentCalculator(){
				
				var principle = document.querySelector("#principleLoan").value;
				var annualInterest = document.querySelector("#annualInterestRate").value;
				annualInterest *= 0.01;
				var monthlyInterest = annualInterest / 12;
				
				if(numMonths == 0 ){
					alert("You must specify a Time Period for the Loan");
				}
				else if(principle === undefined || principle === NaN || principle === ""){
					alert("Please enter a valid value for the Principle Amount");
				} 
				else if(annualInterest === undefined || annualInterest === NaN || annualInterest === ""){
					alert("You must specify a valid value for the Annual Interest");
				}
				else {
					monthlyPayment = ((monthlyInterest) / ((1 - Math.pow((1 + monthlyInterest), -numMonths)))) * principle;
					
					if(submitted == true){
						location.reload();
					}
					
					submitted = true;

					$(".fromTo").css("visibility", "visible");
					
					createTable(principle, numMonths, annualInterest, monthlyInterest, monthlyPayment);
					
					$("#mortgageTable").css("visibility", "visible");
				}
			}
		});

		function createTable(pr, nM, aI, mI, mP){
			
			
			var table = document.getElementById("mortgageTable");
				
				if(table !== null) {

					for(var i = 0;i < nM;i++) {
						
						console.log("here");
												
						if(i % 12 == 0 && i !== 0){
							var tableRow = document.createElement("tr");

							var year = document.createElement("td");
							var yearText = document.createTextNode( "Year " + (i/12 + 1));
							year.appendChild(yearText);
							tableRow.appendChild(year);
							for(var j = 0; j < 4; j++){
								var tableData1 = document.createElement("td");
								var tdText1 = document.createTextNode(" ");
								tableData1.appendChild(tdText1);
								tableRow.appendChild(tableData1);
							}
							table.appendChild(tableRow);
							tableRow.setAttribute("class", "yearRow");
						}
						
						var tableRow = document.createElement("tr");
						
						var tableData1 = document.createElement("td");
						var tdText1 = document.createTextNode(i + 1);
						tableData1.appendChild(tdText1);
						tableRow.appendChild(tableData1);
						
						var tableData2 = document.createElement("td");
						var tdText2 = document.createTextNode(mP.toFixed(2));
						tableData2.appendChild(tdText2);
						tableRow.appendChild(tableData2);
							
						var tableData3 = document.createElement("td");
						var principlePaid = mP - mI * pr;
						var tdText3 = document.createTextNode(principlePaid.toFixed(2));
						tableData3.appendChild(tdText3);
						tableRow.appendChild(tableData3);
												
						var tableData4 = document.createElement("td");
						var tdText4 = document.createTextNode((mI * pr).toFixed(2));
						tableData4.appendChild(tdText4);
						tableRow.appendChild(tableData4);

						var tableData5= document.createElement("td");
						pr -= principlePaid;
						var tdText5 = document.createTextNode((pr).toFixed(2));
						tableData5.appendChild(tdText5);
						tableRow.appendChild(tableData5);
						
						table.appendChild(tableRow);
					}
				}
				
		}
		
		function clear(e) {
								
				location.reload();
		}
		
		function setNumMonths (numMonths) {
			gnumMonths = numMonths;
		}
		function getNumMonths (){
			return gnumMonths;
		}
		
		function timeSpanFunc(e) {
			var first = document.querySelector("#firstMonth").value;
			var last =  document.querySelector("#lastMonth").value;
			var numMonths = getNumMonths() ;		
			
			console.log(numMonths);
			
			var rows = $("#mortgageTable tr").not(".yearRow");
			var years = $("#mortgageTable tr.yearRow");

			//rows = rows.children();
			
			for (var k = 0; k < first; k++){
				if(k %12 == 0){
					$(years[k/12 - 1]).css("display", "none");
				}
				$(rows[k]).css("display", "none");
			}
			
			for(var p = first; p < last; p++){
				if(p %12 == 0){
					$(years[p/12 - 1]).css("display", "table-row");
				}	
				
				$(rows[p]).css("display", "table-row");
			}
			
			for (var m = last; m < numMonths + 1; m++){
				if(m %12 == 0){
					$(years[m/12 - 1]).css("display", "none");
				}
				$(rows[m]).css("display", "none");
			}

		
		}	
			
			
	</script>
	
  </body>
</html>